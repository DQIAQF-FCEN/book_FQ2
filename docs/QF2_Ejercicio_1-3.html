
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Problema 1.3 &#8212; FQ2</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Problema 1.7" href="QF2_Ejercicio_1-7.html" />
    <link rel="prev" title="Content with notebooks" href="notebooks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FQ2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Buscar este libro ..." aria-label="Buscar este libro ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Problema 1.3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="QF2_Ejercicio_1-7.html">
   Problema 1.7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="QF2_Ejercicio_2-5.html">
   Problema 2.5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="QF2_Ejercicio_3-1.html">
   Problema 3.1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="QF2_Ejercicio_3-6.html">
   Problema 3.6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="QF2_Ejercicio_3-18.html">
   Problema 3.18
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="QF2_Ejercicio_5-6.html">
   Problema 5.6
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Navegación de palanca" aria-controls="site-navigation"
                title="Navegación de palanca" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Descarga esta pagina"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/QF2_Ejercicio_1-3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Descargar archivo fuente" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimir en PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Repositorio de origen"><i
                    class="fab fa-github"></i>repositorio</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FQF2_Ejercicio_1-3.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Abrir un problema"><i class="fas fa-lightbulb"></i>Tema abierto</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Modo de pantalla completa"
        title="Modo de pantalla completa"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/QF2_Ejercicio_1-3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Lanzamiento Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Problema 1.3</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="problema-1-3">
<h1>Problema 1.3<a class="headerlink" href="#problema-1-3" title="Permalink to this headline">¶</a></h1>
<p><strong>Problema</strong> 1-3</p>
<p>Para una temperatura de <span class="math notranslate nohighlight">\(723\)</span> K y un volumen molar <span class="math notranslate nohighlight">\(1\)</span> dm<span class="math notranslate nohighlight">\(^{3}\)</span>, empleando los modelos de gas ideal, esferas duras y Van der Waals, graficar entre <span class="math notranslate nohighlight">\(10^{-5}\)</span> y <span class="math notranslate nohighlight">\(500\)</span> bar:</p>
<p>a) <span class="math notranslate nohighlight">\(Z \, \, vs \, \, p\)</span></p>
<p>b) <span class="math notranslate nohighlight">\((Z-1)/p \, \, vs \, \, p\)</span></p>
<p>c) <span class="math notranslate nohighlight">\(\ln \varphi \, \, vs \, \, p\)</span></p>
<p><strong>Resolución:</strong></p>
<p>Este ejercicio nos permitirá no solo aprender/repasar cómo graficar una dada función con python, sino que también sirve de caso de estudio para aprender a integrar numéricamente. ¿Por qué hablamos de integración? Bueno, porque el <span class="math notranslate nohighlight">\(\ln \varphi\)</span> a una dada presión se calcula como la integral de <span class="math notranslate nohighlight">\((Z-1)/p\)</span> entre <span class="math notranslate nohighlight">\(0\)</span> (o <span class="math notranslate nohighlight">\(p\)</span> tendiendo a <span class="math notranslate nohighlight">\(0\)</span>) y la presión a la cual se quiere conocer <span class="math notranslate nohighlight">\(\ln \varphi\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \ln \varphi  = \int_{p \to 0}^{p}\frac{Z-1}{p} dp \]</div>
<p>Pero esto nos lo piden recién en el item c, por lo que primero nos concentraremos en los items <strong>a</strong> y <strong>b</strong>, que son más directos.</p>
<p>Comenzaremos por <strong>importar</strong> algunas <strong>bibliotecas</strong> que nos permitirán realizar operaciones matemáticas y gráficar.</p>
<p>Numpy (<a class="reference external" href="https://numpy.org/">https://numpy.org/</a>) es una de las librerías más poderosas de python, y sus alcances van mucho más allá de lo que utilizaremos en este ejercicio. Nos permite realizar diversas operaciones matemáticas con <strong>arrays</strong> (matrices), leer y escribir archivos .csv, entre otras cosas.</p>
<p>Matplotlib (<a class="reference external" href="https://matplotlib.org/">https://matplotlib.org/</a>) es una librería que permite generar gráficos (y animaciones), y en particular <strong>pyplot</strong> es un subconjunto de funciones de ella que permite generar gráficos de forma particularmente simple.</p>
<p>Para importar numpy y pyplot, ejecutamos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># importo numpy con el alias np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># importo pyplot de matplotlib con el alias plt</span>
</pre></div>
</div>
</div>
</div>
<p>El siguiente paso es cargar nuestras los valores de nuestros parámetrosen el programa. Esto puede realizarse de varias maneras (por ejemplo, podríamos leerlos de un archivo aparte), pero para mantener el código simple, procederemos a asignar los valores de los parámetros a variables dentro del mismo código:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="mf">0.08314</span> <span class="c1"># bar.dm3/K mol</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">3.640</span> <span class="c1"># dm6 bar/mol2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">0.04267</span> <span class="c1"># L/mol</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">373</span> <span class="c1"># K</span>
</pre></div>
</div>
</div>
</div>
<p>Lo que nos conviene ahora es definir funciones para calcular <span class="math notranslate nohighlight">\(Z\)</span> según distintos modelos, que tomen como variables <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(p\)</span> y los parámetros del modelo en particular.</p>
<p>Pero antes de programar, tenemos que resolver nuestro problema en “lápiz y papel”. La estrategia a seguir es, para cada modelo, despejar <span class="math notranslate nohighlight">\(\bar{V}\)</span> en función del resto de las variables, para luego reemplazar en <span class="math notranslate nohighlight">\(Z\)</span>:</p>
<div class="math notranslate nohighlight">
\[ Z = \frac{p \bar{V}}{RT} \]</div>
<ul class="simple">
<li><p>Para gases ideales (GI):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ p = \frac{RT}{\bar{V}} ⇒ \bar{V} = \frac{RT}{p} \]</div>
<p>De modo que:</p>
<div class="math notranslate nohighlight">
\[ Z_{GI} = \frac{p \bar{V}}{RT} = \frac{p}{RT} \ \frac{RT}{p}\]</div>
<div class="math notranslate nohighlight">
\[ \boxed{Z_{GI} = 1}\]</div>
<p>Es decir, <span class="math notranslate nohighlight">\(Z_{GI}\)</span> es siempre igual a <span class="math notranslate nohighlight">\(1\)</span>, para cualquier <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>No es necesario definir una función en este caso, pero lo haremos de todas maneras para mantener la “homogeneidad” de nuestro enfoque:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calcularZ_GI</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">):</span> 
  <span class="k">return</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>El caso de esferas duras (GED) también es relativamente sencillo, por que podemos despejar <span class="math notranslate nohighlight">\(\bar{V}\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ p = \frac{RT}{\bar{V}-b} ⇒ \bar{V} = \frac{RT}{p}+b \]</div>
<p>Y luego,</p>
<div class="math notranslate nohighlight">
\[ Z_{GED} = \frac{p \bar{V}}{RT} = \frac{p}{RT} \ (\frac{RT}{p}+b)\]</div>
<div class="math notranslate nohighlight">
\[ \boxed{ Z_{GED} = 1+\frac{p \ b}{RT} }\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calcularZ_GED</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">):</span> 
  <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">+</span><span class="mf">1.0</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Por último, caso del modelo de Van de Waals (VdW) es un poco más complejo, debido a que es difícil “despejar” <span class="math notranslate nohighlight">\(\bar{V}\)</span>. Más precisamente, requiere encontrar las raíces de un polinomio de grado tres.</p></li>
</ul>
<p>Para VdW:</p>
<div class="math notranslate nohighlight">
\[ p=\frac{RT}{\bar{V}-b}-\frac{a}{\bar{V}^{2}} \]</div>
<p>Se obtiene que:</p>
<div class="math notranslate nohighlight">
\[ p\bar{V}^{3}-(b \ p + RT)\bar{V}^{2}+a \bar{V} - a \ b=0 \]</div>
<p>De modo que si queremos saber, para una dada presión y temperatura, el volumen molar del gas, tenemos que encontrar las raíces del polinomio <span class="math notranslate nohighlight">\(f(\bar{V})\)</span>:</p>
<div class="math notranslate nohighlight">
\[ f(\bar{V})=A \bar{V}^{3} + B \bar{V}^{2} + C \bar{V} + D \]</div>
<p>Donde:</p>
<div class="math notranslate nohighlight">
\[ A = p \qquad B = -(b \ p + RT) \qquad C = a \qquad D = -ab \]</div>
<p>Lo primero a notar es que no habrá una única solución. Sin embargo, solo una de las soluciones tendrá significado fisicoquímico*. Nos quedaremos con la solución real más grande.</p>
<hr class="docutils" />
<p>( * ) No es trivial de demostrar, pero las otras serán o bien, negativas, o bien, imaginarias, o bien, cercanas a <span class="math notranslate nohighlight">\(b\)</span>. Esto está relacionado con que los coeficientes <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(C\)</span> y <span class="math notranslate nohighlight">\(D\)</span> no pueden valer cualquier cosa, sino que algunos están relacionados entre ellos, otros tienen siempre signo definido, etc. (ver <em>fórmulas de Vieta</em>, que relacionan las raíces de los polinomios con sus coeficientes).</p>
<hr class="docutils" />
<p>Para resolver este problema, utilizaremos la función <strong>roots</strong>  de <strong>numpy</strong>, que recibe como input una lista con los coeficientes del polinomio y da como resultado un <strong>array</strong> con sus raíces. Tendremos que tener un cuidado extra, puesto que no queremos cualquier raíz, sino la real más grande:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Primero calculamos los coeficientes del polinomio</span>

<span class="k">def</span> <span class="nf">calcularZ_VdW</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">):</span> 
  <span class="c1">#Primero calculamos los coeficientes del polinomio</span>
  <span class="n">A</span><span class="o">=</span><span class="n">p</span>
  <span class="n">B</span><span class="o">=-</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
  <span class="n">C</span><span class="o">=</span><span class="n">a</span>
  <span class="n">D</span><span class="o">=-</span><span class="n">a</span><span class="o">*</span><span class="n">b</span>
  <span class="c1">#Ahora llamamos la función root de numpy</span>
  <span class="n">raices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">])</span>
  <span class="c1">#Guardamos en una lista las raíces reales</span>
  <span class="n">raices_reales</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#lista vacía donde las vamos a guardar</span>
  <span class="k">for</span> <span class="n">raiz</span> <span class="ow">in</span> <span class="n">raices</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">raiz</span><span class="p">):</span> <span class="c1">#usamos la función isreal para ver si el elemento es real</span>
        <span class="n">raices_reales</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">raiz</span><span class="p">))</span> <span class="c1">#si es real, la guardamos</span>
  <span class="c1">#Nuestro Vmolar es el máximo de los valores de la lista:</span>
  <span class="n">Vm</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">raices_reales</span><span class="p">)</span>
  <span class="c1">#Solo queda calcular Z</span>
  <span class="k">return</span> <span class="n">p</span><span class="o">*</span><span class="n">Vm</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Y con algo de esfuerzo para este último caso, ya tenemos nuestras funciones calcularZ_GI, calcularZ_GED y calcularZ_VdW que, recibiendo como input <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(T\)</span> y los parámetros del modelo, calculan <span class="math notranslate nohighlight">\(Z\)</span>.</p>
<hr class="docutils" />
<p>Nota: Esto podríamos haberlo resuelto también con un “solver” que encuentre numéricamente qué valor de <span class="math notranslate nohighlight">\(\bar{V}\)</span> resuelve la ecuación$. En particular la biblioteca fsolve de scipy.optimize es muy útil para realizar este tipo de tareas, como veremos más adelante en la segunda parte de la materia.</p>
<hr class="docutils" />
<p>Ahora solo nos queda generar una lista de presiones, calcular <span class="math notranslate nohighlight">\(Z\)</span> para cada una de ellas, y guardar estos <span class="math notranslate nohighlight">\(Z\)</span> en otra lista</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">#Para generar una lista de presiones, genero un array de numpy de 1000 elementos entre 10-5 y 500</span>
<span class="n">lista_Z_GI</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#Genero lista vacía donde voy a guardar los Z asociados a cada presión</span>
<span class="n">lista_Z_GED</span><span class="o">=</span><span class="p">[]</span>
<span class="n">lista_Z_VdW</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">lista_p</span><span class="p">:</span>
   <span class="n">lista_Z_GI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calcularZ_GI</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
   <span class="n">lista_Z_GED</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calcularZ_GED</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
   <span class="n">lista_Z_VdW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calcularZ_VdW</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Y ya podemos graficar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_Z_GI</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_Z_GED</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GED&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_Z_VdW</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;VdW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p (bar)&#39;</span><span class="p">)</span> <span class="c1"># Rótulo de eje horizontal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span> <span class="c1">#Rótulo de eje vertical</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> <span class="c1">#Para mostrar la leyenda de cada línea graficada</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#Para mostrar graficar la figura en pantalla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/QF2_Ejercicio_1-3_16_0.png" src="_images/QF2_Ejercicio_1-3_16_0.png" />
</div>
</div>
<p><strong>b)</strong> El plot de <span class="math notranslate nohighlight">\((Z-1)/p\)</span> requiere generar nuevas listas a partir de las anteriores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista_Zmenos1sobreP_GI</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#Genero lista vacía donde voy a guardar los Z asociados a cada presión</span>
<span class="n">lista_Zmenos1sobreP_GED</span><span class="o">=</span><span class="p">[]</span>
<span class="n">lista_Zmenos1sobreP_VdW</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lista_p</span><span class="p">)):</span> <span class="c1">#i va a ir desde 0 hasta la dimensión de lista_p -no inclusive-</span>
    <span class="n">lista_Zmenos1sobreP_GI</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lista_Z_GI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> 
    <span class="n">lista_Zmenos1sobreP_GED</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lista_Z_GED</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> 
    <span class="n">lista_Zmenos1sobreP_VdW</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lista_Z_VdW</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Y ya tenemos en una lista valores de <span class="math notranslate nohighlight">\((Z-1)/p\)</span>. Antes de graficar, vamos ya a determinar <span class="math notranslate nohighlight">\(\ln \varphi\)</span>.</p>
<p><strong>c)</strong> La estrategia que utilizaremos será la de integrar numéricamente la expresión anterior. Realizaremos la integración entre el primer elemento de nuestro array de presiones (que es una presión cercana a cero), y la presión que querramos.</p>
<p>El método que utilizaremos será el conocido como método trapezoidal, y lo implementaremos nosotros mismos. La figura siguiente intenta describir cómo se aproxima el área debajo de la curva con este método, dibujando un trapezoide, y calculando su área:</p>
<p><img alt="" src="https://drive.google.com/uc?export=view&amp;id=1sT4Z5EDXb9R9WRj2RUlymb2LjgatcWlo" /></p>
<p>Luego, obtenemos <span class="math notranslate nohighlight">\(\ln \varphi\)</span> como (el código es un poco largo porque los nombres que elegimos para nuestras listas son excesivamente declarativos, pero leánlo con atención que se parece a lo que venimos haciendo hasta ahora):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista_lnphi_GI</span><span class="o">=</span><span class="p">[]</span>
<span class="n">lista_lnphi_GI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1">#a p-&gt;0 asumimos la integral da 0</span>
<span class="n">valor_GI</span><span class="o">=</span><span class="mf">0.0</span>
<span class="n">lista_lnphi_GED</span><span class="o">=</span><span class="p">[]</span>
<span class="n">lista_lnphi_GED</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1">#a p-&gt;0 asumimos la integral da 0</span>
<span class="n">valor_GED</span><span class="o">=</span><span class="mf">0.0</span>
<span class="n">lista_lnphi_VdW</span><span class="o">=</span><span class="p">[]</span>
<span class="n">lista_lnphi_VdW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1">#a p-&gt;0 asumimos la integral da 0</span>
<span class="n">valor_VdW</span><span class="o">=</span><span class="mf">0.0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lista_p</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1">#como en cada iteración miramos el elemento i y el i+1, no barremos hasta el último elemento de p sino el anteúltimo</span>
    <span class="n">valor_GI</span><span class="o">=</span><span class="n">valor_GI</span><span class="o">+</span><span class="p">(</span><span class="n">lista_Zmenos1sobreP_GI</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lista_Zmenos1sobreP_GI</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">valor_GED</span><span class="o">=</span><span class="n">valor_GED</span><span class="o">+</span><span class="p">(</span><span class="n">lista_Zmenos1sobreP_GED</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lista_Zmenos1sobreP_GED</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">valor_VdW</span><span class="o">=</span><span class="n">valor_VdW</span><span class="o">+</span><span class="p">(</span><span class="n">lista_Zmenos1sobreP_VdW</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lista_Zmenos1sobreP_VdW</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lista_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">lista_lnphi_GI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valor_GI</span><span class="p">)</span>
    <span class="n">lista_lnphi_GED</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valor_GED</span><span class="p">)</span>
    <span class="n">lista_lnphi_VdW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valor_VdW</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_Zmenos1sobreP_GI</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_Zmenos1sobreP_GED</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GED&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_Zmenos1sobreP_VdW</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;VdW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p (bar)&#39;</span><span class="p">)</span> <span class="c1"># Rótulo de eje horizontal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;(Z-1)/p&#39;</span><span class="p">)</span> <span class="c1">#Rótulo de eje vertical</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> <span class="c1">#Para mostrar la leyenda de cada línea graficada</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#Para mostrar graficar la figura en pantalla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/QF2_Ejercicio_1-3_22_0.png" src="_images/QF2_Ejercicio_1-3_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_lnphi_GI</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_lnphi_GED</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GED&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lista_p</span><span class="p">,</span><span class="n">lista_lnphi_VdW</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;VdW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p (bar)&#39;</span><span class="p">)</span> <span class="c1"># Rótulo de eje horizontal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;lnphi&#39;</span><span class="p">)</span> <span class="c1">#Rótulo de eje vertical</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> <span class="c1">#Para mostrar la leyenda de cada línea graficada</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#Para mostrar graficar la figura en pantalla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/QF2_Ejercicio_1-3_23_0.png" src="_images/QF2_Ejercicio_1-3_23_0.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="notebooks.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Content with notebooks</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="QF2_Ejercicio_1-7.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Problema 1.7</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Por Proyecto UBACyT<br/>
    
        &copy; Derechos de autor 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>